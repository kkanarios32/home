[{"DOI": "10.48550/arXiv.2402.11592", "URL": "https://arxiv.org/abs/2402.11592", "abstract": "In the evolving landscape of natural language processing (NLP), fine-tuning pre-trained Large Language Models (LLMs) with first-order (FO) optimizers like SGD and Adam has become standard. Yet, as LLMs grow {in size}, the substantial memory overhead from back-propagation (BP) for FO gradient computation presents a significant challenge. Addressing this issue is crucial, especially for applications like on-device training where memory efficiency is paramount. This paper proposes a shift towards BP-free, zeroth-order (ZO) optimization as a solution for reducing memory costs during LLM fine-tuning, building on the initial concept introduced by MeZO. Unlike traditional ZO-SGD methods, our work expands the exploration to a wider array of ZO optimization techniques, through a comprehensive, first-of-its-kind benchmarking study across five LLM families (Roberta, OPT, LLaMA, Vicuna, Mistral), three task complexities, and five fine-tuning schemes. Our study unveils previously overlooked optimization principles, highlighting the importance of task alignment, the role of the forward gradient method, and the balance between algorithm complexity and fine-tuning performance. We further introduce novel enhancements to ZO optimization, including block-wise descent, hybrid training, and gradient sparsity. Our study offers a promising direction for achieving further memory-efficient LLM fine-tuning. Codes to reproduce all our experiments are at https://github.com/ZO-Bench/ZO-LLM .", "accessed": {"date-parts": [[2024, 9, 8]]}, "author": [{"family": "Zhang", "given": "Yihua"}, {"family": "Li", "given": "Pingzhi"}, {"family": "Hong", "given": "Junyuan"}, {"family": "Li", "given": "Jiaxiang"}, {"family": "Zhang", "given": "Yimeng"}, {"family": "Zheng", "given": "Wenqing"}, {"family": "Chen", "given": "Pin-Yu"}, {"family": "Lee", "given": "Jason D."}, {"family": "Yin", "given": "Wotao"}, {"family": "Hong", "given": "Mingyi"}, {"family": "Wang", "given": "Zhangyang"}, {"family": "Liu", "given": "Sijia"}, {"family": "Chen", "given": "Tianlong"}], "id": "zhangRevisitingZerothOrderOptimization2024", "issued": {"date-parts": [[2024, 5]]}, "keyword": "Computer Science - Computation and Language,Computer Science - Machine Learning", "number": "arXiv:2402.11592", "publisher": "arXiv", "title": "Revisiting Zeroth-Order Optimization for Memory-Efficient LLM Fine-Tuning: A Benchmark", "title-short": "Revisiting Zeroth-Order Optimization for Memory-Efficient LLM Fine-Tuning", "type": "", "original_bibtex": "@misc{zhangRevisitingZerothOrderOptimization2024,\n title = {Revisiting {{Zeroth-Order Optimization}} for {{Memory-Efficient LLM Fine-Tuning}}: {{A Benchmark}}},\n author = {Zhang, Yihua and Li, Pingzhi and Hong, Junyuan and Li, Jiaxiang and Zhang, Yimeng and Zheng, Wenqing and Chen, Pin-Yu and Lee, Jason D. and Yin, Wotao and Hong, Mingyi and Wang, Zhangyang and Liu, Sijia and Chen, Tianlong},\n year = {2024},\n doi = {10.48550/arXiv.2402.11592},\n urldate = {2024-09-08},\n number = {arXiv:2402.11592},\n publisher = {arXiv},\n file = {/home/kellen/Zotero/storage/3FC8QZYA/Zhang et al. - 2024 - Revisiting Zeroth-Order Optimization for Memory-Efficient LLM Fine-Tuning A Benchmark.pdf},\n keywords = {Computer Science - Computation and Language,Computer Science - Machine Learning},\n archiveprefix = {arXiv},\n abstract = {In the evolving landscape of natural language processing (NLP), fine-tuning pre-trained Large Language Models (LLMs) with first-order (FO) optimizers like SGD and Adam has become standard. Yet, as LLMs grow \\{in size\\}, the substantial memory overhead from back-propagation (BP) for FO gradient computation presents a significant challenge. Addressing this issue is crucial, especially for applications like on-device training where memory efficiency is paramount. This paper proposes a shift towards BP-free, zeroth-order (ZO) optimization as a solution for reducing memory costs during LLM fine-tuning, building on the initial concept introduced by MeZO. Unlike traditional ZO-SGD methods, our work expands the exploration to a wider array of ZO optimization techniques, through a comprehensive, first-of-its-kind benchmarking study across five LLM families (Roberta, OPT, LLaMA, Vicuna, Mistral), three task complexities, and five fine-tuning schemes. Our study unveils previously overlooked optimization principles, highlighting the importance of task alignment, the role of the forward gradient method, and the balance between algorithm complexity and fine-tuning performance. We further introduce novel enhancements to ZO optimization, including block-wise descent, hybrid training, and gradient sparsity. Our study offers a promising direction for achieving further memory-efficient LLM fine-tuning. Codes to reproduce all our experiments are at https://github.com/ZO-Bench/ZO-LLM .},\n primaryclass = {cs},\n eprint = {2402.11592},\n month = {May},\n shorttitle = {Revisiting {{Zeroth-Order Optimization}} for {{Memory-Efficient LLM Fine-Tuning}}}\n}\n"}]